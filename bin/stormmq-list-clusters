#!/usr/bin/env ruby
# encoding: utf-8
#--
# Copyright (c) 2010, Tony Byrne & StormMQ Ltd.
# All rights reserved.
#
# Please refer to the LICENSE file that accompanies this source
# for terms of use and redistribution.
#++

$:.unshift File.dirname(__FILE__) + '/../lib'
require 'rubygems'
require 'commandline/optionparser'
require 'stormmq'

class StormMQ::Application::ListCompanies < StormMQ::Application

  def initialize
    synopsis  "[--user USER] --company COMPANY"
    short_description "Lists the companies available to you (typically one)"
    long_description  ""
    options :help

    option :names           => %w(--user -u),
           :opt_description => "a valid user name, i.e. the login you use at http://stormmq.com/",
           :arity           => [1,1],
           :opt_found       => get_args

    option :names           => %w(--company -c),
          :opt_description => "your company identifier, usually the same as --user",
          :arity           => [1,1],
          :opt_found       => get_args,
          :opt_not_found   => CommandLine::OptionParser::OPT_NOT_FOUND_BUT_REQUIRED
  end

  def main
    StormMQ::Rest.new(:user => @user).clusters(opt.company).each {|c| puts c }
  end

end

__END__
